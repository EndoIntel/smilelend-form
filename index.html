<script>
  const form = document.getElementById('intake-form');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const responseDiv = document.getElementById('response');

    try {
      const data = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        dob: document.getElementById('dob').value,
        plaidConsent: document.getElementById('plaidConsent').checked,
        experianConsent: document.getElementById('experianConsent').checked
      };

      const res = await fetch('https://smilelend-api.vercel.app/api/submit-intake', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      const result = await res.json();
      responseDiv.innerText = result.success
        ? '✅ Submitted successfully!'
        : '❌ API Error: ' + result.error;

    } catch (err) {
      responseDiv.innerText = '❌ JS Error: ' + err.message;
      console.error('Form JS error:', err);
    }
  });
</script>
